<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>木马自检程序</title>

<link rel="stylesheet" href="css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" />
<link rel="stylesheet" type="text/css" href="css/base.css">
<script language="javascript" src="js/jquery.min.js" type="text/javascript"></script>	
<script type="text/javascript" src="js/admin.jquery.configuration.js"></script>

<script language="javascript" src="js/global.js"></script>
<script language="javascript" src="../include/js/dedeajax2.js"></script>
<script language='javascript'>

function LoadCtTest()
{
	var filetype = $Obj('filetype').value;
	var info = $Obj('info').value;
	$Obj('loaddiv').style.display='block';
	var myajax = new DedeAjax($DE('messagetd'));
	myajax.SendGet2('sys_safetest.php?action=test&filetype=' + filetype + "&info=" + info);
	$Obj('loaddiv').style.display='none';
}

function LoadCtClear()
{
	$Obj('loaddiv').style.display='block';
	var myajax = new DedeAjax($DE('messagetd'));
	myajax.SendGet2('sys_safetest.php?action=clear');
	$Obj('loaddiv').style.display='none';
}

</script>
</head>
<body>
<div id="body-wrapper"> <!-- Wrapper for the radial gradient background -->
<?php include(DEDEADMIN.'/templets/menu.htm'); ?>
<script language="javascript">
$("#sys").addClass("current");$("#sys_safetest").addClass("current");</script>				

	<div class="content-box"><!-- Start Content Box -->
				
				<div class="content-box-header">
					
					<h3>木马自检程序</h3>
					
					<ul class="content-box-tabs">

					</ul>
					
					<div class="clear"></div>
					
				</div> <!-- End .content-box-header -->
				
				<div class="content-box-content">
					
<div class="tab-content  default-tab" id="tab1">				
<div id='loaddiv' style='display:none'>
	<p align='center' style='padding-top:200px'><img src='images/loadinglit.gif' /> 请稍后，正在操作中...</p>
</div>

<table width="98%" border="0" cellpadding="1" cellspacing="1" align="center" class="tbtitle" style="background:#CFCFCF;">

  <tr>
    <td height="73" colspan="2" bgcolor="#FFFFFF">
     <strong>安全建议：</strong>
    	<br />
      1、有条件的用户把中 data、templets、uploads、html、special、images、install目录设置为不允许执行脚本，其它目录禁止写入，系统将更安全；<br />
      2、本检测程以开发模式为标准，如果您的网站目录包含其它系统，此检测程序可能会产生错误判断；<br />
      3、检测程序会跳过对模板缓存目录的检测，为了安全起见，检测完成后建议清空模板缓存。
    </td>
  </tr>
  <tr>
    <td height="50" colspan="2" bgcolor="#FFFFFF"><p>文件类型：
        <input name="filetype" type="text" id="filetype" value="php|inc" style="width:420px"/> 
    &nbsp;要检查的文件类型</p>
    <p>代码特征：
      <input name="info" type="text" id="info" value="eval|cmd|system|exec|_GET|_POST" style="width:420px"/>
    &nbsp;特征代码</p></td>
  </tr>
  <tr>
    <td height="50" colspan="2" bgcolor="#FFFFFF">
    <input class="button" name="bt1" type="button" value="开始检测" onclick="LoadCtTest();" />

    &nbsp;
    <input class="button" name="bt2" type="button" value="清空模板缓存" onclick="LoadCtClear();" />
   
	</td>
  </tr>
  <tr>
    <td colspan="2">检测结果：(结果仅供参考，请务必查看源码后才删除非法文件)</td>
  </tr>
  <tr>
    <td height="300" colspan="2" id="messagetd" valign="top" bgcolor="#FFFFFF">
    </td>
  </tr>
</table>
							<div class="clear"></div><!-- End .clear -->
							
						
						
					</div> <!-- End #tab1 -->

					
				</div> <!-- End .content-box-content -->
				
			</div> <!-- End .content-box -->
			
			<div class="clear"></div>
			
           <?php include(DEDEADMIN.'/templets/footer.htm'); ?>
			
		</div> <!-- End #main-content -->	
	</div>
</body>
</html>
